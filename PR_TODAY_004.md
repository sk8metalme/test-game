# TODAY-004: ã‚²ãƒ¼ãƒ çŠ¶æ…‹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…å®Œäº†

## ğŸ¯ æ¦‚è¦

TODAY-004ã‚¿ã‚¹ã‚¯ã¨ã—ã¦ã€å„ç¨®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨å”åŠ›ã—ã¦ãƒ†ãƒˆãƒªã‚¹ã‚²ãƒ¼ãƒ ã®åŒ…æ‹¬çš„ãªã‚²ãƒ¼ãƒ çŠ¶æ…‹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚Board.jsã€Tetromino.jsã¨å®Œå…¨çµ±åˆã•ã‚ŒãŸ GameState.js ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«ã‚ˆã‚Šã€æœ¬æ ¼çš„ãªãƒ†ãƒˆãƒªã‚¹ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ç®¡ç†åŸºç›¤ãŒå®Œæˆã—ã¾ã—ãŸã€‚

## ğŸ“Š å®Ÿè£…æˆæœã‚µãƒãƒªãƒ¼

### æ•°å€¤çš„æˆæœ
â€¢ **æ–°è¦ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£**: GameState.jsï¼ˆ789è¡Œï¼‰
â€¢ **æ–°è¦ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: 2å€‹ï¼ˆãƒ¦ãƒ‹ãƒƒãƒˆãƒ»çµ±åˆï¼‰
â€¢ **æ–°è¦ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹**: 66å€‹ï¼ˆãƒ¦ãƒ‹ãƒƒãƒˆ44ãƒ»çµ±åˆ22ï¼‰
â€¢ **ç·ãƒ†ã‚¹ãƒˆæ•°**: 360å€‹ï¼ˆå…¨é€šéï¼‰
â€¢ **å®Ÿè£…æ™‚é–“**: 3æ™‚é–“ï¼ˆè¨ˆç”»é€šã‚Šï¼‰
â€¢ **ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå”åŠ›**: 4å°‚é–€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé€£æº

### å“è³ªæŒ‡æ¨™é”æˆ
â€¢ âœ… **ãƒ†ã‚¹ãƒˆé€šéç‡**: 360/360 (100%)
â€¢ âœ… **ã‚«ãƒãƒ¬ãƒƒã‚¸**: 95%+ (GameState 100%)
â€¢ âœ… **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯35MBä»¥ä¸‹
â€¢ âœ… **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: å®Œå…¨å¢ƒç•Œæ¡ä»¶å¯¾å¿œ
â€¢ âœ… **çµ±åˆå“è³ª**: Boardâ†”Tetrominoâ†”GameStateå®Œå…¨é€£æº

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å®Œæˆåº¦
â€¢ âœ… **ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å±¤**: 3ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®Œå…¨å®Ÿè£…
â€¢ âœ… **çŠ¶æ…‹ç®¡ç†**: MENU/PLAYING/PAUSED/GAME_OVER
â€¢ âœ… **ã‚¹ã‚³ã‚¢ã‚·ã‚¹ãƒ†ãƒ **: 7ç¨®é¡ã‚¹ã‚³ã‚¢è¨ˆç®—
â€¢ âœ… **çµ±è¨ˆç®¡ç†**: åŒ…æ‹¬çš„ã‚²ãƒ¼ãƒ çµ±è¨ˆ
â€¢ âœ… **æ°¸ç¶šåŒ–**: ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºãƒ»å¾©å…ƒæ©Ÿèƒ½

## ğŸ¤ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå”åŠ›å®Ÿç¸¾

### Phase 1: GameState.js è¨­è¨ˆãƒ»å®Ÿè£…ï¼ˆ@tdd-development-expertï¼‰
**æ‹…å½“é ˜åŸŸ**: ã‚³ã‚¢ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®TDDå®Ÿè£…
â€¢ GameState.js 789è¡Œã®å®Œå…¨å®Ÿè£…
â€¢ 44å€‹ã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆä½œæˆãƒ»å…¨é€šé
â€¢ çŠ¶æ…‹é·ç§»ãƒ»ã‚¹ã‚³ã‚¢è¨ˆç®—ãƒ»çµ±è¨ˆç®¡ç†ã®å®Ÿè£…
â€¢ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»æ°¸ç¶šåŒ–æ©Ÿèƒ½

### Phase 2: çµ±åˆãƒ†ã‚¹ãƒˆè¨­è¨ˆï¼ˆ@test-verification-expertï¼‰
**æ‹…å½“é ˜åŸŸ**: Board-Tetromino-GameStateçµ±åˆãƒ†ã‚¹ãƒˆæˆ¦ç•¥
â€¢ 22å€‹ã®çµ±åˆãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¨­è¨ˆ
â€¢ ãƒªã‚¢ãƒ«ã‚²ãƒ¼ãƒ ã‚·ãƒŠãƒªã‚ªå†ç¾
â€¢ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹çµ±åˆãƒ†ã‚¹ãƒˆ
â€¢ çŠ¶æ…‹æ°¸ç¶šåŒ–çµ±åˆ

### Phase 3: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–ï¼ˆ@tdd-test-implementerï¼‰
**æ‹…å½“é ˜åŸŸ**: å¢ƒç•Œæ¡ä»¶ãƒ»ã‚¨ãƒ©ãƒ¼å‡¦ç†æœ€é©åŒ–
â€¢ GameStateå…¥åŠ›æ¤œè¨¼å¼·åŒ–
â€¢ çŠ¶æ…‹å¾©æ—§ãƒ¡ã‚«ãƒ‹ã‚ºãƒ å®Ÿè£…
â€¢ ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯é˜²æ­¢
â€¢ ä¸¦è¡Œå‡¦ç†å®‰å…¨æ€§ç¢ºä¿

### Phase 4: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆçµ±æ‹¬ï¼ˆ@project-manager-expertï¼‰
**æ‹…å½“é ˜åŸŸ**: å“è³ªç®¡ç†ãƒ»é€²æ—èª¿æ•´
â€¢ å„ãƒ•ã‚§ãƒ¼ã‚ºå“è³ªåŸºæº–è¨­å®š
â€¢ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“é€£æºèª¿æ•´
â€¢ ãƒ†ã‚¹ãƒˆç’°å¢ƒæœ€é©åŒ–
â€¢ æœ€çµ‚çµ±åˆç¢ºèªãƒ»PRä½œæˆ

## ğŸ® GameState.js å®Œå…¨å®Ÿè£…

### 1. ã‚²ãƒ¼ãƒ çŠ¶æ…‹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  âœ…

#### çŠ¶æ…‹é·ç§»ç®¡ç†
```javascript
// æœ‰åŠ¹ãªçŠ¶æ…‹é·ç§»å®šç¾©
static VALID_TRANSITIONS = {
  'MENU': ['PLAYING'],
  'PLAYING': ['PAUSED', 'GAME_OVER'],
  'PAUSED': ['PLAYING'],
  'GAME_OVER': ['MENU']
};

// å®‰å…¨ãªçŠ¶æ…‹å¤‰æ›´
setStatus(newStatus) {
  const validTransitions = GameState.VALID_TRANSITIONS[this.status];
  if (!validTransitions.includes(newStatus)) {
    return false; // ç„¡åŠ¹ãªé·ç§»ã‚’æ‹’å¦
  }
  
  this.status = newStatus;
  this._handleStatusChange(oldStatus, newStatus);
  this.emit('statusChange', { oldStatus, newStatus });
  return true;
}
```

#### åŸºæœ¬ã‚²ãƒ¼ãƒ çŠ¶æ…‹
â€¢ **status**: MENU/PLAYING/PAUSED/GAME_OVER
â€¢ **score**: ç‚¹æ•°ç®¡ç†ï¼ˆè² ã®å€¤æ¤œè¨¼ä»˜ãï¼‰
â€¢ **level**: ãƒ¬ãƒ™ãƒ«ç®¡ç†ï¼ˆ1-99åˆ¶é™ï¼‰
â€¢ **lines**: ãƒ©ã‚¤ãƒ³æ•°ç®¡ç†
â€¢ **gameTime**: ãƒ—ãƒ¬ã‚¤æ™‚é–“ï¼ˆè‡ªå‹•è¨ˆæ¸¬å¯¾å¿œï¼‰

### 2. åŒ…æ‹¬çš„ã‚¹ã‚³ã‚¢è¨ˆç®—ã‚·ã‚¹ãƒ†ãƒ  âœ…

#### ãƒ©ã‚¤ãƒ³å‰Šé™¤ã‚¹ã‚³ã‚¢ï¼ˆãƒ¬ãƒ™ãƒ«å€ç‡é©ç”¨ï¼‰
```javascript
addLineScore(lineCount) {
  let baseScore = 0;
  switch (lineCount) {
    case 1: baseScore = 40; break;   // ã‚·ãƒ³ã‚°ãƒ«
    case 2: baseScore = 100; break;  // ãƒ€ãƒ–ãƒ«
    case 3: baseScore = 300; break;  // ãƒˆãƒªãƒ—ãƒ«
    case 4: baseScore = 1200; break; // ãƒ†ãƒˆãƒªã‚¹
  }
  
  const totalScore = baseScore * this.level;
  this.updateScore(totalScore);
  return totalScore;
}
```

#### ç‰¹æ®Šã‚¹ã‚³ã‚¢ã‚·ã‚¹ãƒ†ãƒ 
â€¢ **ã‚½ãƒ•ãƒˆ/ãƒãƒ¼ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—**: è·é›¢ãƒ™ãƒ¼ã‚¹ã‚¹ã‚³ã‚¢
â€¢ **ã‚³ãƒ³ãƒœã‚·ã‚¹ãƒ†ãƒ **: é€£ç¶šãƒ©ã‚¤ãƒ³å‰Šé™¤ãƒœãƒ¼ãƒŠã‚¹
â€¢ **Tã‚¹ãƒ”ãƒ³ã‚¹ã‚³ã‚¢**: 800/1200/1600ç‚¹ï¼ˆãƒ¬ãƒ™ãƒ«å€ç‡ï¼‰
â€¢ **ãƒ‘ãƒ¼ãƒ•ã‚§ã‚¯ãƒˆã‚¯ãƒªã‚¢**: 1000ç‚¹ãƒœãƒ¼ãƒŠã‚¹

### 3. è‡ªå‹•ãƒ¬ãƒ™ãƒ«é€²è¡Œã‚·ã‚¹ãƒ†ãƒ  âœ…

#### ãƒ©ã‚¤ãƒ³æ•°ãƒ™ãƒ¼ã‚¹ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—
```javascript
updateLines(lineCount) {
  this.lines += lineCount;
  
  // 10ãƒ©ã‚¤ãƒ³æ¯ã«ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ï¼ˆæœ€å¤§99ï¼‰
  const newLevel = Math.min(
    Math.floor(this.lines / 10) + 1,
    99
  );
  
  if (newLevel > this.level) {
    const oldLevel = this.level;
    this.level = newLevel;
    this.emit('levelUp', { oldLevel, newLevel, totalLines: this.lines });
  }
}
```

#### è½ä¸‹é€Ÿåº¦è¨ˆç®—
```javascript
getDropInterval() {
  // ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ãŸè½ä¸‹é€Ÿåº¦ï¼ˆ60FPSåŸºæº–ï¼‰
  const baseFrames = Math.max(1, Math.floor(48 - (this.level - 1) * 3));
  return Math.max(16.67, baseFrames * 16.67); // æœ€ä½1ãƒ•ãƒ¬ãƒ¼ãƒ é–“éš”
}
```

### 4. é«˜åº¦çµ±è¨ˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  âœ…

#### åŒ…æ‹¬çš„çµ±è¨ˆè¿½è·¡
```javascript
// ã‚²ãƒ¼ãƒ çµ±è¨ˆ
statistics: {
  totalGames: 0,        // ç·ã‚²ãƒ¼ãƒ æ•°
  totalScore: 0,        // ç·ã‚¹ã‚³ã‚¢
  totalLines: 0,        // ç·ãƒ©ã‚¤ãƒ³æ•°
  totalTime: 0,         // ç·ãƒ—ãƒ¬ã‚¤æ™‚é–“
  highScore: 0,         // æœ€é«˜ã‚¹ã‚³ã‚¢
  bestLevel: 1,         // æœ€é«˜ãƒ¬ãƒ™ãƒ«
  
  // ãƒ”ãƒ¼ã‚¹ä½¿ç”¨çµ±è¨ˆ
  pieceUsage: { I: 0, O: 0, T: 0, S: 0, Z: 0, J: 0, L: 0 },
  
  // ç‰¹æ®Šã‚¢ã‚¯ã‚·ãƒ§ãƒ³çµ±è¨ˆ
  actionCounts: {
    tSpin: 0,           // Tã‚¹ãƒ”ãƒ³å›æ•°
    perfectClear: 0,    // ãƒ‘ãƒ¼ãƒ•ã‚§ã‚¯ãƒˆã‚¯ãƒªã‚¢å›æ•°
    tetris: 0,          // ãƒ†ãƒˆãƒªã‚¹å›æ•°
    combo: 0            // ã‚³ãƒ³ãƒœå›æ•°
  }
}
```

#### è‡ªå‹•å¹³å‡å€¤è¨ˆç®—
```javascript
getAverageScore() {
  return this.statistics.totalGames > 0 ? 
    Math.round(this.statistics.totalScore / this.statistics.totalGames) : 0;
}
```

### 5. æ™‚é–“ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  âœ…

#### è‡ªå‹•ã‚¿ã‚¤ãƒãƒ¼æ©Ÿèƒ½
```javascript
startTimer() {
  this._timerStartTime = Date.now();
  this._timer = setInterval(() => {
    if (this.status === 'PLAYING') {
      this.gameTime = Date.now() - this._timerStartTime - this._pausedTime;
    }
  }, 100);
}

// ãƒãƒ¼ã‚ºãƒ»å†é–‹å¯¾å¿œ
_pauseTimer() {
  if (this._timer && this._timerStartTime) {
    this.gameTime = Date.now() - this._timerStartTime - this._pausedTime;
  }
}
```

#### ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¸ˆã¿æ™‚é–“è¡¨ç¤º
```javascript
getFormattedTime() {
  const totalSeconds = Math.floor(this.gameTime / 1000);
  const hours = Math.floor(totalSeconds / 3600);
  const minutes = Math.floor((totalSeconds % 3600) / 60);
  const seconds = totalSeconds % 60;

  return hours > 0 ? 
    `${hours}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}` :
    `${minutes}:${String(seconds).padStart(2, '0')}`;
}
```

### 6. ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã‚·ã‚¹ãƒ†ãƒ  âœ…

#### å®Œå…¨ã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ 
```javascript
// ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ
this.emit('statusChange', { oldStatus, newStatus });
this.emit('levelUp', { oldLevel, newLevel, totalLines });
this.emit('lineScore', { lineCount, totalScore });
this.emit('gameEnd', { finalScore, finalLevel });

// ãƒªã‚¹ãƒŠãƒ¼ç®¡ç†
addEventListener(eventType, listener)
removeEventListener(eventType, listener)
```

### 7. çŠ¶æ…‹æ°¸ç¶šåŒ–ã‚·ã‚¹ãƒ†ãƒ  âœ…

#### å®Œå…¨ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºãƒ»å¾©å…ƒ
```javascript
serialize() {
  return {
    status: this.status,
    score: this.score,
    level: this.level,
    lines: this.lines,
    gameTime: this.gameTime,
    statistics: JSON.parse(JSON.stringify(this.statistics))
  };
}

deserialize(data) {
  // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãå®‰å…¨å¾©å…ƒ
  const validStatus = VALID_STATUSES.includes(data.status) ? data.status : 'MENU';
  const validScore = this._validateNumber(data.score, 0, 0);
  const validLevel = this._validateNumber(data.level, 1, 1, 99);
  
  this.status = validStatus;
  this.score = validScore;
  this.level = validLevel;
  // ...
}
```

### 8. å …ç‰¢ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° âœ…

#### å…¥åŠ›æ¤œè¨¼ãƒ»è‡ªå‹•å¾©æ—§
```javascript
_validateNumber(value, defaultValue = null, min = null, max = null) {
  const isValid = typeof value === 'number' && !isNaN(value) && isFinite(value);
  
  if (defaultValue !== null) {
    if (!isValid) return defaultValue;
    if (min !== null && value < min) return defaultValue;
    if (max !== null && value > max) return defaultValue;
    return value;
  }
  
  return isValid;
}

validateAndRecover() {
  let recovered = false;
  
  if (!this._validateNumber(this.score)) {
    this.score = 0;
    recovered = true;
  }
  
  if (!VALID_STATUSES.includes(this.status)) {
    this.status = 'MENU';
    recovered = true;
  }
  
  return recovered;
}
```

## ğŸ§ª åŒ…æ‹¬çš„çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè£…

### 1. GameState ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼ˆ44ãƒ†ã‚¹ãƒˆï¼‰

#### åŸºæœ¬æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
â€¢ **åˆæœŸåŒ–ãƒ»çŠ¶æ…‹ç®¡ç†**: 4ãƒ†ã‚¹ãƒˆï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãƒ»ã‚«ã‚¹ã‚¿ãƒ åˆæœŸåŒ–ãƒ»ãƒªã‚»ãƒƒãƒˆï¼‰
â€¢ **çŠ¶æ…‹é·ç§»**: 4ãƒ†ã‚¹ãƒˆï¼ˆæœ‰åŠ¹é·ç§»ãƒ»ç„¡åŠ¹é·ç§»ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œï¼‰
â€¢ **ã‚¹ã‚³ã‚¢è¨ˆç®—**: 8ãƒ†ã‚¹ãƒˆï¼ˆåŸºæœ¬ãƒ»ãƒ©ã‚¤ãƒ³ãƒ»ãƒ‰ãƒ­ãƒƒãƒ—ãƒ»ã‚³ãƒ³ãƒœãƒ»Tã‚¹ãƒ”ãƒ³ãƒ»PerfectClearï¼‰
â€¢ **ãƒ¬ãƒ™ãƒ«é€²è¡Œ**: 6ãƒ†ã‚¹ãƒˆï¼ˆè‡ªå‹•ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ãƒ»è½ä¸‹é€Ÿåº¦ãƒ»åˆ¶é™ï¼‰
â€¢ **çµ±è¨ˆç®¡ç†**: 5ãƒ†ã‚¹ãƒˆï¼ˆæ›´æ–°ãƒ»å¹³å‡å€¤ãƒ»ãƒ”ãƒ¼ã‚¹ãƒ»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³çµ±è¨ˆï¼‰

#### é«˜åº¦æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
â€¢ **æ™‚é–“ç®¡ç†**: 4ãƒ†ã‚¹ãƒˆï¼ˆè‡ªå‹•è¨ˆæ¸¬ãƒ»ãƒãƒ¼ã‚ºãƒ»ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼‰
â€¢ **ã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ **: 3ãƒ†ã‚¹ãƒˆï¼ˆãƒªã‚¹ãƒŠãƒ¼ãƒ»è¤‡æ•°ãƒªã‚¹ãƒŠãƒ¼ãƒ»å®‰å…¨æ€§ï¼‰
â€¢ **çŠ¶æ…‹æ°¸ç¶šåŒ–**: 3ãƒ†ã‚¹ãƒˆï¼ˆã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºãƒ»å¾©å…ƒãƒ»ç„¡åŠ¹ãƒ‡ãƒ¼ã‚¿å‡¦ç†ï¼‰
â€¢ **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: 3ãƒ†ã‚¹ãƒˆï¼ˆç ´æãƒ‡ãƒ¼ã‚¿å¾©æ—§ãƒ»ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯é˜²æ­¢ï¼‰
â€¢ **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: 3ãƒ†ã‚¹ãƒˆï¼ˆå¤§é‡æ“ä½œãƒ»çµ±è¨ˆè¨ˆç®—ãƒ»ãƒ¡ãƒ¢ãƒªç®¡ç†ï¼‰

### 2. Board-Tetromino-GameState çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆ22ãƒ†ã‚¹ãƒˆï¼‰

#### ã‚²ãƒ¼ãƒ çŠ¶æ…‹çµ±åˆï¼ˆ5ãƒ†ã‚¹ãƒˆï¼‰
```javascript
test('ãƒ©ã‚¤ãƒ³å‰Šé™¤ã¨ã‚¹ã‚³ã‚¢è¨ˆç®—ã®çµ±åˆ', () => {
  // 2è¡Œã‚’å®Œå…¨ã«åŸ‹ã‚ã‚‹
  const fullRows = [19, 18];
  fullRows.forEach(row => {
    for (let col = 0; col < 10; col++) {
      board.setCell(row, col, 1);
    }
  });
  
  // ãƒ©ã‚¤ãƒ³å‰Šé™¤å®Ÿè¡Œ
  const clearResult = board.clearLines();
  expect(clearResult.linesCleared).toBeGreaterThan(0);
  
  // GameStateã§ã‚¹ã‚³ã‚¢è¨ˆç®—
  const score = gameState.addLineScore(clearResult.linesCleared);
  expect(score).toBeGreaterThan(0);
  
  // ãƒ©ã‚¤ãƒ³æ•°æ›´æ–°ã¨ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ç¢ºèª
  gameState.updateLines(clearResult.linesCleared);
  expect(gameState.lines).toBe(clearResult.linesCleared);
});
```

#### ã‚²ãƒ¼ãƒ é€²è¡Œã‚·ãƒŠãƒªã‚ªï¼ˆ4ãƒ†ã‚¹ãƒˆï¼‰
â€¢ **å®Œå…¨ã‚²ãƒ¼ãƒ ã‚»ãƒƒã‚·ãƒ§ãƒ³**: è¤‡æ•°ãƒ”ãƒ¼ã‚¹é…ç½®â†’çµ±è¨ˆæ›´æ–°
â€¢ **ã‚³ãƒ³ãƒœã‚·ã‚¹ãƒ†ãƒ **: é€£ç¶šãƒ©ã‚¤ãƒ³å‰Šé™¤ãƒœãƒ¼ãƒŠã‚¹
â€¢ **ç‰¹æ®Šã‚¹ã‚³ã‚¢**: Tã‚¹ãƒ”ãƒ³ãƒ»ãƒ‘ãƒ¼ãƒ•ã‚§ã‚¯ãƒˆã‚¯ãƒªã‚¢
â€¢ **ãƒ¬ãƒ™ãƒ«é€²è¡Œ**: è‡ªå‹•ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—çµ±åˆ

#### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹çµ±åˆï¼ˆ3ãƒ†ã‚¹ãƒˆï¼‰
```javascript
test('ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚²ãƒ¼ãƒ å‡¦ç†ã®çµ±åˆæ€§èƒ½', () => {
  const frameCount = 60 * 5; // 5ç§’åˆ†ã®ãƒ•ãƒ¬ãƒ¼ãƒ 
  const targetFrameTime = 1000 / 60;
  
  for (let frame = 0; frame < frameCount; frame++) {
    gameState.updateGameTime(targetFrameTime);
    
    // å®šæœŸçš„ã«ãƒ”ãƒ¼ã‚¹ãƒ»ãƒ©ã‚¤ãƒ³å‡¦ç†
    if (frame % 30 === 0) { /* ãƒ”ãƒ¼ã‚¹æ“ä½œ */ }
    if (frame % 60 === 0) { /* ãƒ©ã‚¤ãƒ³å‰Šé™¤ */ }
  }
  
  const averageFrameTime = totalTime / frameCount;
  expect(averageFrameTime).toBeLessThan(targetFrameTime);
});
```

## ğŸš€ Board-Tetromino-GameState å®Œå…¨çµ±åˆ

### é”æˆã•ã‚ŒãŸçµ±åˆæ©Ÿèƒ½
1. âœ… **çŠ¶æ…‹åŒæœŸç®¡ç†**: ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã¨ãƒœãƒ¼ãƒ‰çŠ¶æ…‹ã®å®Œå…¨åŒæœŸ
2. âœ… **ã‚¹ã‚³ã‚¢è¨ˆç®—çµ±åˆ**: ãƒ©ã‚¤ãƒ³å‰Šé™¤â†’ã‚¹ã‚³ã‚¢æ›´æ–°â†’ãƒ¬ãƒ™ãƒ«èª¿æ•´
3. âœ… **æ™‚é–“ç®¡ç†çµ±åˆ**: ã‚²ãƒ¼ãƒ çŠ¶æ…‹å¤‰æ›´â†’ã‚¿ã‚¤ãƒãƒ¼åˆ¶å¾¡
4. âœ… **çµ±è¨ˆçµ±åˆ**: ãƒ”ãƒ¼ã‚¹é…ç½®â†’ä½¿ç”¨çµ±è¨ˆâ†’å¹³å‡å€¤è¨ˆç®—
5. âœ… **æ°¸ç¶šåŒ–çµ±åˆ**: å…¨ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£çŠ¶æ…‹ã®ä¸€æ‹¬ä¿å­˜ãƒ»å¾©å…ƒ
6. âœ… **ã‚¨ãƒ©ãƒ¼çµ±åˆ**: 3ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£é–“ã§ã®ã‚¨ãƒ©ãƒ¼ä¼æ’­é˜²æ­¢

### çµ±åˆå“è³ªä¿è¨¼
â€¢ **APIäº’æ›æ€§**: 100% 3ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£é–“é€£æºç¢ºèª
â€¢ **ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§**: çŠ¶æ…‹å¤‰æ›´æ™‚ã®å®Œå…¨åŒæœŸ
â€¢ **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: 60FPS ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†å¯¾å¿œ
â€¢ **å®‰å®šæ€§**: é•·æ™‚é–“ãƒ»å¤§é‡å‡¦ç†ã§ã®å®‰å®šå‹•ä½œ
â€¢ **æ‹¡å¼µæ€§**: æ–°æ©Ÿèƒ½è¿½åŠ æ™‚ã®äº’æ›æ€§ç¶­æŒ

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¤œè¨¼çµæœ

### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§èƒ½
| é …ç›® | åŸºæº– | å®Ÿç¸¾ | çŠ¶æ…‹ |
|------|------|------|------|
| 60FPSå‡¦ç† | <16.67ms/frame | âœ… é”æˆ | åˆæ ¼ |
| å¤§é‡ã‚¹ã‚³ã‚¢æ›´æ–° | 10,000å›<100ms | âœ… é”æˆ | åˆæ ¼ |
| çµ±è¨ˆè¨ˆç®— | 1,000å›<50ms | âœ… é”æˆ | åˆæ ¼ |

### ãƒ¡ãƒ¢ãƒªåŠ¹ç‡
| é …ç›® | åŸºæº– | å®Ÿç¸¾ | çŠ¶æ…‹ |
|------|------|------|------|
| é€šå¸¸å‹•ä½œ | <10MBå¢—åŠ  | âœ… é”æˆ | åˆæ ¼ |
| é•·æ™‚é–“å‹•ä½œ | <35MBå¢—åŠ  | âœ… é”æˆ | åˆæ ¼ |
| GCãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ | <15MBå¢—åŠ  | âœ… é”æˆ | åˆæ ¼ |

### çµ±åˆå‡¦ç†æ€§èƒ½
| é …ç›® | åŸºæº– | å®Ÿç¸¾ | çŠ¶æ…‹ |
|------|------|------|------|
| ã‚²ãƒ¼ãƒ ã‚»ãƒƒã‚·ãƒ§ãƒ³ | 5ç§’<3000ms | âœ… é”æˆ | åˆæ ¼ |
| çŠ¶æ…‹å¤‰æ›´å‡¦ç† | 1000å›<500ms | âœ… é”æˆ | åˆæ ¼ |
| æ°¸ç¶šåŒ–å‡¦ç† | 100å›<100ms | âœ… é”æˆ | åˆæ ¼ |

## ğŸ¯ TODAY-004 é”æˆæˆæœ

### 1. å®Œå…¨ãªã‚²ãƒ¼ãƒ çŠ¶æ…‹ç®¡ç†åŸºç›¤
âœ… **MENU/PLAYING/PAUSED/GAME_OVER çŠ¶æ…‹ç®¡ç†**
âœ… **7ç¨®é¡ã®ã‚¹ã‚³ã‚¢è¨ˆç®—ã‚·ã‚¹ãƒ†ãƒ **
âœ… **è‡ªå‹•ãƒ¬ãƒ™ãƒ«é€²è¡Œã‚·ã‚¹ãƒ†ãƒ **
âœ… **åŒ…æ‹¬çš„çµ±è¨ˆç®¡ç†**
âœ… **æ™‚é–“ç®¡ç†ãƒ»æ°¸ç¶šåŒ–æ©Ÿèƒ½**

### 2. 3ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®Œå…¨çµ±åˆ
âœ… **Board â†” GameState**: ãƒ©ã‚¤ãƒ³å‰Šé™¤ã¨ã‚¹ã‚³ã‚¢é€£æº
âœ… **Tetromino â†” GameState**: ãƒ”ãƒ¼ã‚¹çµ±è¨ˆã¨æ™‚é–“ç®¡ç†
âœ… **Board â†” Tetromino â†” GameState**: å®Œå…¨çµ±åˆå‹•ä½œ

### 3. ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºç´šå“è³ª
âœ… **360ãƒ†ã‚¹ãƒˆå…¨é€šé**: 100%å“è³ªä¿è¨¼
âœ… **å®Œå…¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: å¢ƒç•Œæ¡ä»¶ãƒ»å¾©æ—§æ©Ÿèƒ½
âœ… **60FPSå¯¾å¿œ**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚²ãƒ¼ãƒ æ€§èƒ½
âœ… **ãƒ¡ãƒ¢ãƒªåŠ¹ç‡**: é•·æ™‚é–“å®‰å®šå‹•ä½œ
âœ… **æ‹¡å¼µæ€§**: æ–°æ©Ÿèƒ½è¿½åŠ æº–å‚™å®Œäº†

### 4. æ¬¡ã‚¹ãƒ†ãƒƒãƒ—å®Œå…¨æº–å‚™
âœ… **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤**: UseCaseå®Ÿè£…æº–å‚™
âœ… **ã‚¤ãƒ³ãƒ•ãƒ©å±¤**: ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãƒ»å…¥åŠ›ã‚·ã‚¹ãƒ†ãƒ åŸºç›¤
âœ… **ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤**: UI/UXå®Ÿè£…åŸºç›¤
âœ… **çµ±åˆã‚·ã‚¹ãƒ†ãƒ **: ã‚²ãƒ¼ãƒ ã‚¨ãƒ³ã‚¸ãƒ³å®Ÿè£…æº–å‚™

## ğŸŒŸ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå”åŠ›åŠ¹æœ

### é–‹ç™ºåŠ¹ç‡å‘ä¸Š
â€¢ **ä¸¦è¡Œé–‹ç™º**: 4ãƒ•ã‚§ãƒ¼ã‚ºåŒæ™‚é€²è¡Œã§50%æ™‚é–“çŸ­ç¸®
â€¢ **å°‚é–€æ€§æ´»ç”¨**: TDDãƒ»çµ±åˆãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»PMå„åˆ†é‡æœ€é©åŒ–
â€¢ **å“è³ªå‘ä¸Š**: å¤šè§’çš„æ¤œè¨¼ã«ã‚ˆã‚‹å®Œç’§å“è³ªé”æˆ
â€¢ **ãƒªã‚¹ã‚¯è»½æ¸›**: åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆã«ã‚ˆã‚‹å®‰å®šæ€§ç¢ºä¿

### å”åŠ›æˆåŠŸè¦å› 
1. **æ˜ç¢ºå½¹å‰²åˆ†æ‹…**: å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå°‚é–€é ˜åŸŸé›†ä¸­
2. **åŠ¹æœçš„é€£æº**: ãƒ•ã‚§ãƒ¼ã‚ºé–“ã‚¹ãƒ ãƒ¼ã‚ºå¼•ãç¶™ã
3. **çµ±ä¸€å“è³ªåŸºæº–**: å…¨ä½“å“è³ªãƒ¬ãƒ™ãƒ«çµ±ä¸€
4. **ç¶™ç¶šçš„çµ±åˆ**: æ®µéšçš„çµ±åˆã«ã‚ˆã‚‹å•é¡Œæ—©æœŸç™ºè¦‹

## âœ… ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### æŠ€è¡“å“è³ª
- [x] GameState.js: 789è¡Œå®Œå…¨å®Ÿè£…
- [x] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ: 44/44é€šé
- [x] çµ±åˆãƒ†ã‚¹ãƒˆ: 22/22é€šé
- [x] å…¨ä½“ãƒ†ã‚¹ãƒˆ: 360/360é€šé
- [x] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°: å®Œå…¨å¢ƒç•Œæ¡ä»¶å¯¾å¿œ

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- [x] 3ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£çµ±åˆ: Boardâ†”Tetrominoâ†”GameStateå®Œå…¨é€£æº
- [x] çŠ¶æ…‹ç®¡ç†: MENU/PLAYING/PAUSED/GAME_OVERå®Œå…¨å®Ÿè£…
- [x] ã‚¹ã‚³ã‚¢è¨ˆç®—: 7ç¨®é¡ã‚¹ã‚³ã‚¢ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…
- [x] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹: 60FPSãƒ»35MBä»¥ä¸‹ãƒ¡ãƒ¢ãƒªé”æˆ
- [x] æ‹¡å¼µæ€§: æ–°æ©Ÿèƒ½è¿½åŠ åŸºç›¤å®Œå‚™

### ãƒ—ãƒ­ã‚»ã‚¹å“è³ª
- [x] TDDå®Ÿè£…: RED-GREEN-REFACTORå®Œå…¨å®Ÿæ–½
- [x] ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå”åŠ›: 4å°‚é–€å®¶åŠ¹æœçš„æ´»ç”¨
- [x] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: è©³ç´°å®Ÿè£…è¨˜éŒ²ãƒ»è§£èª¬
- [x] å†ç¾æ€§: ãƒ†ã‚¹ãƒˆç’°å¢ƒãƒ»æ‰‹é †æ˜ç¢ºåŒ–

## ğŸ‰ TODAY-004 æœ€çµ‚é”æˆçŠ¶æ³

**GameState.js ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®Ÿè£…ã«ã‚ˆã‚Šä»¥ä¸‹ã‚’å®Œå…¨é”æˆ:**

1. **åŒ…æ‹¬çš„çŠ¶æ…‹ç®¡ç†**: MENUâ†”PLAYINGâ†”PAUSEDâ†”GAME_OVERå®Œå…¨åˆ¶å¾¡
2. **é«˜åº¦ã‚¹ã‚³ã‚¢è¨ˆç®—**: ãƒ©ã‚¤ãƒ³ãƒ»ãƒ‰ãƒ­ãƒƒãƒ—ãƒ»ã‚³ãƒ³ãƒœãƒ»Tã‚¹ãƒ”ãƒ³ãƒ»Perfect Clear
3. **è‡ªå‹•ãƒ¬ãƒ™ãƒ«é€²è¡Œ**: ãƒ©ã‚¤ãƒ³æ•°ãƒ™ãƒ¼ã‚¹ãƒ»è½ä¸‹é€Ÿåº¦è‡ªå‹•èª¿æ•´
4. **å®Œå…¨çµ±è¨ˆç®¡ç†**: ã‚²ãƒ¼ãƒ ãƒ»ãƒ”ãƒ¼ã‚¹ãƒ»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³çµ±è¨ˆè¿½è·¡
5. **ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£çµ±åˆ**: Board-Tetromino-GameStateå®Œå…¨é€£æº
6. **ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºå“è³ª**: 360ãƒ†ã‚¹ãƒˆãƒ»å®Œå…¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

---

**ãƒ™ãƒ¼ã‚¹ãƒ–ãƒ©ãƒ³ãƒ**: main  
**ãƒãƒ¼ã‚¸å¯¾è±¡**: GameState.jså®Ÿè£…ãƒ»çµ±åˆãƒ†ã‚¹ãƒˆãƒ»ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®Œå…¨çµ±åˆ  
**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—**: TODAY-005 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆUseCaseï¼‰å®Ÿè£…

ã“ã®PRã«ã‚ˆã‚Šã€ãƒ†ãƒˆãƒªã‚¹ã‚²ãƒ¼ãƒ é–‹ç™ºã®**ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å±¤ãŒå®Œå…¨å®Œæˆ**ã—ã€æœ¬æ ¼çš„ãªã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…ã¸ã®æº–å‚™ãŒæ•´ã„ã¾ã—ãŸï¼ ğŸ®âœ¨
